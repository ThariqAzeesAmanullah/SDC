import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score
from google.colab import files
import io

# ğŸ“¦ Upload the dataset
uploaded = files.upload()

# âœ… Automatically get the uploaded filename
csv_filename = list(uploaded.keys())[0]

# ğŸ§¾ Read the CSV into a DataFrame
try:
    df = pd.read_csv(io.BytesIO(uploaded[csv_filename]))
except Exception as e:
    print("âŒ Error loading CSV:", e)
    raise

# âœ… Check required columns
required_columns = {"Size (sq ft)", "Bedrooms", "Location Score", "Price ($)"}
if not required_columns.issubset(df.columns):
    raise ValueError(f"âŒ CSV is missing required columns: {required_columns - set(df.columns)}")

# ğŸ¯ Define features and target
X = df[["Size (sq ft)", "Bedrooms", "Location Score"]]
y = df["Price ($)"]

# ğŸ”€ Split the data
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# ğŸ“ˆ Train the Linear Regression Model
model = LinearRegression()
model.fit(X_train, y_train)

# ğŸ”® Get user input with error handling
print("\nğŸ”® Enter details of the house to predict price:")
try:
    new_size = int(input("ğŸ“ Size (sq ft): "))
    new_bedrooms = int(input("ğŸ›ï¸ Number of Bedrooms: "))
    new_loc_score = int(input("ğŸ“ Location Score (1-10): "))
except ValueError:
    print("âŒ Please enter valid numeric values.")
    raise

# ğŸ§  Predict the price
new_house = pd.DataFrame([[new_size, new_bedrooms, new_loc_score]],
                         columns=["Size (sq ft)", "Bedrooms", "Location Score"])
predicted_price = model.predict(new_house)

print(f"\nğŸ’° Predicted Price: ${predicted_price[0]:,.2f}")

# ğŸ“Š Optional: Show model evaluation
y_pred = model.predict(X_test)
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)
print("\nğŸ“ˆ Model Evaluation:")
print(f"ğŸ”¹ Mean Squared Error: {mse:.2f}")
print(f"ğŸ”¹ RÂ² Score: {r2:.2f}")
